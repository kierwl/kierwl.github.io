---
layout: post
comments: true
title:  "ì‚¬ë‹¤ë¦¬ êµ¬í˜„í•˜ê¸° 2"
excerpt: "ì½”ë“œ í•™ìŠµ"
categories: 
- ìœ ë‹ˆí‹°
- ìŠ¤íŒŒë¥´íƒ€
tags:
- TIL
 
toc_label: íŒ€í”„ë¡œì íŠ¸
toc: true
toc_sticky: true
 
date: 2025-04-10	
last_modified_at: 2025-04-10
---

### ğŸ“† ì˜¤ëŠ˜ì˜ TIL (Today I Learned)

# ì‚¬ë‹¤ë¦¬(Ladder) ì˜¤ë¥´ê¸° ì‹œìŠ¤í…œ ì½”ë“œ ë¶„ì„ ë° TIL

ê¸°ì¡´ì˜ ì½”ë“œëŠ” ì½œë¼ì´ë”ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¶©ëŒì˜ì—­ì„ ë¹„í™œì„±í™” í•˜ì—¬ ì‘ë™í•˜ì˜€ë‹¤.

ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ ë¬¸ì œì ì€ í”Œë«í¼ìœ„ì— RBê°€ ì ìš©ëœ ì‚¬ë¬¼ì´ ìˆëŠ”ê²½ìš° í”Œë ˆì´ì–´ê°€ ì‚¬ë‹¤ë¦¬ì— ì˜¤ë¥´ë©´ ê°™ì´ ë–¨ì–´ì§€ëŠ” ë¬¸ì œê°€ ìƒê²¼ë‹¤.

ì´ë¥¼ í•´ê²° í•˜ê¸° ìœ„í•´ ë‹¤ì‹œ ì›ì ìœ¼ë¡œ ëŒì•„ê°€ì„œ ë ˆì´ì–´ë§ˆìŠ¤í¬ì˜ íŠ¹ì • ì½œë¼ì´ë”ë§Œ ë¬´ì‹œí•˜ëŠ” Physicsìì²´í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆì§€ë§Œ ì‚¬ë‹¤ë¦¬ë¥¼ íƒ€ê³  ì˜¬ë¼ê°€ë˜ì¤‘ í”Œë«í¼ ì½œë¼ì´ë”ì™€ ì¶©ëŒí•˜ì—¬ ê³§ë°”ë¡œ ì¶”ë½í•˜ëŠ” ë¬¸ì œê°€ ìƒê²¼ë‹¤.

ì—¬ëŸ¬ ê³ ë¯¼ì„ í†µí•´ ë‹¤ì–‘í•œ ì ‘ê·¼ì„ í•´ë³´ì•˜ì§€ë§Œ ë¬¸ì œë¥¼ í•´ê²°í•˜ì§€ ëª»í–ˆê³  ì €ë… ìŠ¤í¬ëŸ¼ì‹œê°„ëŒ€ì— íŒ€ì›ì´ ë³´ì—¬ì¤€ íŠ¹ì • ë ˆì´ì–´ë§Œ ì´¬ì˜í•´ì„œ ë³´ì—¬ì£¼ëŠ” ë¯¸ë‹ˆë§µì„ ë³´ê³  ì˜ê°ì„ ì–»ì—ˆë‹¤.

í”Œë ˆì´ì–´ì˜ ë ˆì´ì–´ë¥¼ Physics ì¶©ëŒì²˜ë¦¬ë¥¼ ë¬´ì‹œí•˜ëŠ” ë ˆì´ì–´ë¥¼ í•˜ë‚˜ ë§Œë“¤ê³  ì´ê±¸ë¡œ ë³€ê²½í•˜ê²Œ ë˜ë©´ íŠ¸ë¦¬ê±°ë¡œ ì‘ë™í•˜ëŠ” ì½œë¼ì´ë”ë¥¼ ì œì™¸í•˜ê³  ëª¨ë“  ì½œë¼ì´ë”ë¥¼ ë¬´ì‹œí•˜ê²Œ ëœë‹¤.

ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ì½”ë“œë¥¼ ë¦¬íŒ©í† ë§ í•´ë³´ì•˜ë‹¤.

## ì£¼ìš” ê¸°ëŠ¥

1. ë ˆì´ì–´ ê´€ë¦¬
   - ì‚¬ë‹¤ë¦¬ ìƒíƒœì¼ ë•Œ í”Œë ˆì´ì–´ì˜ ë ˆì´ì–´ë¥¼ NoCollisionìœ¼ë¡œ ë³€ê²½í•˜ì—¬ í”Œë«í¼ê³¼ì˜ ì¶©ëŒì„ ë°©ì§€
   - ìƒíƒœ ì¢…ë£Œ ì‹œ ì›ë˜ ë ˆì´ì–´ë¡œ ë³µì›
2. ì¤‘ì•™ ì •ë ¬
   - í”Œë ˆì´ì–´ê°€ ì‚¬ë‹¤ë¦¬ì— ì ‘ê·¼í•˜ë©´ í•­ìƒ ì‚¬ë‹¤ë¦¬ì˜ ì¤‘ì•™ X ì¢Œí‘œì— ì •ë ¬
   - Updateì™€ FixedUpdate ëª¨ë‘ì—ì„œ ê°•ì œ ì •ë ¬ì„ ìœ ì§€í•˜ì—¬ í”ë“¤ë¦¼ ë°©ì§€
3. ì…ë ¥ ì²˜ë¦¬
   - ìƒí•˜ ë°©í–¥í‚¤: ì‚¬ë‹¤ë¦¬ ì˜¤ë¥´ë‚´ë¦¬ê¸° ë™ì‘
   - ì¢Œìš° ë°©í–¥í‚¤: ì‚¬ë‹¤ë¦¬ì—ì„œ ì¦‰ì‹œ ë‚´ë¦¬ê¸°
   - ì í”„ ë²„íŠ¼: ì‚¬ë‹¤ë¦¬ì—ì„œ ì í”„í•˜ë©° ë‚´ë¦¬ê¸°

## í•µì‹¬ ì½”ë“œ ë¶„ì„

### 1. ì‚¬ë‹¤ë¦¬ ì§„ì… ë° ë ˆì´ì–´ ë³€ê²½

```csharp
public override void Enter()
{
    Debug.Log("ì‚¬ë‹¤ë¦¬ ì˜¤ë¥´ê¸° ìƒíƒœ ì§„ì…");

    // ì§„ì… ìƒíƒœ í™•ì¸ (ì•„ë˜ë¡œ ë‚´ë ¤ê°€ëŠ”ì§€, í”Œë«í¼ì—ì„œ ì‹œì‘í•˜ëŠ”ì§€)
    var inputHandler = player.GetInputHandler();
    var collisionDetector = player.GetCollisionDetector();
    
    // ì•„ë˜í‚¤ë¥¼ ëˆŒëŸ¬ ì ‘ê·¼í•˜ëŠ”ì§€ ì²´í¬
    isEnteringFromBottom = inputHandler.MoveDirection.y < 0;
    
    // í”Œë«í¼ì—ì„œ ì‹œì‘í•˜ëŠ”ì§€ ì²´í¬
    isStartingFromPlatform = collisionDetector.IsGrounded;
    
    // ì¤‘ë ¥ ë¹„í™œì„±í™” ë° ì„¤ì • ì €ì¥
    var rigidbody = player.GetComponent<Rigidbody2D>();
    if (rigidbody != null)
    {
        originalGravity = new Vector2(rigidbody.gravityScale, Physics2D.gravity.y);
        
        // ì•„ë˜í‚¤ë¥¼ ëˆŒëŸ¬ ì‚¬ë‹¤ë¦¬ ì§„ì… ì‹œ (í”Œë«í¼ì—ì„œ)
        if (isStartingFromPlatform && isEnteringFromBottom)
        {
            // ì•½ê°„ì˜ ì´ˆê¸° ì†ë„ ë¶€ì—¬ (ì•„ë˜ë¡œ)
            rigidbody.gravityScale = 0.1f;
            rigidbody.velocity = new Vector2(0, -0.8f);
            entryDelayTimer = PLATFORM_ENTRY_DELAY;
        }
        else
        {
            // ì¼ë°˜ ì‚¬ë‹¤ë¦¬ ì§„ì… ì‹œ ì¤‘ë ¥ ì™„ì „ ì œê±°
            rigidbody.gravityScale = 0f;
            rigidbody.velocity = Vector2.zero;
        }
    }
    
    // í”Œë ˆì´ì–´ ë ˆì´ì–´ë¥¼ NoCollisionìœ¼ë¡œ ì¦‰ì‹œ ë³€ê²½
    ChangePlayerToLadderLayer();
    
    // ì‚¬ë‹¤ë¦¬ ì°¾ê¸° ë° í”Œë ˆì´ì–´ ì¤‘ì•™ ì •ë ¬
    FindLadderAndCenterPlayer();
}
```

### 2. ì‚¬ë‹¤ë¦¬ ì¤‘ì•™ ì •ë ¬ ë¡œì§

```csharp
private void CenterPlayerOnLadder(Collider2D ladderCollider)
{
    if (ladderCollider == null) return;

    // í˜„ì¬ ì‚¬ë‹¤ë¦¬ ì½œë¼ì´ë” ì €ì¥
    currentLadderCollider = ladderCollider;

    // ì‚¬ë‹¤ë¦¬ì˜ ì¤‘ì•™ X ì¢Œí‘œ ê³„ì‚°
    ladderCenterX = ladderCollider.bounds.center.x;

    // í”Œë ˆì´ì–´ì˜ ìœ„ì¹˜ë¥¼ ì‚¬ë‹¤ë¦¬ ì¤‘ì•™ X ì¢Œí‘œë¡œ ì¦‰ì‹œ ì„¤ì •
    var playerTransform = player.transform;
    Vector3 newPosition = playerTransform.position;
    newPosition.x = ladderCenterX;

    // í”Œë ˆì´ì–´ ìœ„ì¹˜ ì„¤ì •
    playerTransform.position = newPosition;
}
```

### 3. ì…ë ¥ ì²˜ë¦¬ ë° ì‚¬ë‹¤ë¦¬ ìƒíƒœ ì¢…ë£Œ ì¡°ê±´

```csharp
public override void HandleInput()
{
    var inputHandler = player.GetInputHandler();
    var collisionDetector = player.GetCollisionDetector();

    // ì…ë ¥ì´ ìƒí•˜ ë°©í–¥í‚¤ê°€ ì•„ë‹Œ ê²½ìš° ì‚¬ë‹¤ë¦¬ì—ì„œ ë‚´ë¦¬ê¸°
    Vector2 input = inputHandler.MoveDirection;

    // ìƒí•˜ ë°©í–¥í‚¤ê°€ ëˆŒë ¤ìˆì§€ ì•Šê³  ì¢Œìš° ë°©í–¥í‚¤ê°€ ëˆŒë ¤ìˆìœ¼ë©´ ì¦‰ì‹œ ì‚¬ë‹¤ë¦¬ì—ì„œ ë‚´ë¦¼
    if (Mathf.Abs(input.y) < 0.1f && Mathf.Abs(input.x) > 0.1f)
    {
        Debug.Log("ì¢Œìš° ì…ë ¥ ê°ì§€ - ì‚¬ë‹¤ë¦¬ì—ì„œ ë‚´ë¦¬ê¸°");
        isExitingLadder = true;
        player.ExitClimbingState(false);
        return;
    }

    // ì í”„ ë²„íŠ¼ì´ ëˆŒë¦¬ë©´ ì‚¬ë‹¤ë¦¬ì—ì„œ ì í”„í•˜ë©° ë‚´ë¦¼
    if (inputHandler.JumpPressed)
    {
        Debug.Log("ì í”„ ì…ë ¥ ê°ì§€ - ì‚¬ë‹¤ë¦¬ì—ì„œ ì í”„í•˜ì—¬ ë‚´ë¦¬ê¸°");
        isExitingLadder = true;
        player.ExitClimbingState(true);
        return;
    }
}
```

### 4. ì‚¬ë‹¤ë¦¬ ë°”ë‹¥ ê°ì§€ ë° ì²˜ë¦¬

```csharp
private void CheckIfAtLadderBottom()
{
    if (currentLadderCollider == null) return;

    // ì‚¬ë‹¤ë¦¬ì˜ í•˜ë‹¨ë¶€ ìœ„ì¹˜ ê³„ì‚°
    float ladderBottom = currentLadderCollider.bounds.min.y;
    float playerBottom = player.GetComponent<Collider2D>().bounds.min.y;
    
    // í”Œë ˆì´ì–´ê°€ ì‚¬ë‹¤ë¦¬ í•˜ë‹¨ ê·¼ì²˜ì— ìˆëŠ”ì§€ í™•ì¸ (ì•½ê°„ì˜ ì—¬ìœ  ì¶”ê°€)
    float threshold = 0.2f; // ì‚¬ë‹¤ë¦¬ ë°”ë‹¥ íŒì • ì—¬ìœ ê°’
    isAtLadderBottom = Mathf.Abs(playerBottom - ladderBottom) < threshold;
}
```

### 5. FixedUpdateì—ì„œì˜ ì´ë™ ì²˜ë¦¬

```csharp
public override void FixedUpdate()
{
    var inputHandler = player.GetInputHandler();
    var movement = player.GetMovement();
    var rigidbody = player.GetComponent<Rigidbody2D>();
    
    // í”Œë«í¼ì—ì„œ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ê¸° ì²˜ë¦¬
    if (isStartingFromPlatform && isEnteringFromBottom && entryDelayTimer > 0)
    {
        // ì•„ë˜ë¡œ ë‚´ë ¤ê°€ëŠ” ì´ë™ ë²¡í„° ìƒì„±
        Vector2 downVelocity = new Vector2(0, -climbSpeed);
        movement.ClimbMove(downVelocity);
        return;
    }

    // ì…ë ¥ í™•ì¸ ë° ì´ë™ ì†ë„ ê³„ì‚°
    Vector2 moveInput = inputHandler.MoveDirection;

    // ì‚¬ë‹¤ë¦¬ ì˜¤ë¥´ë‚´ë¦¬ê¸° - ìˆ˜ì§ ì´ë™ë§Œ ì²˜ë¦¬ (ì¢Œìš° ì´ë™ì€ ë¬´ì‹œ)
    Vector2 climbVelocity = new Vector2(0f, moveInput.y * climbSpeed);

    // ì‚¬ë‹¤ë¦¬ ì¤‘ê°„ì— í”Œë«í¼ê³¼ ì¶©ëŒ ì‹œ ì•„ë˜ë¡œ ì´ë™ ê°€ëŠ¥í•˜ë„ë¡ ì²˜ë¦¬
    var collisionDetector = player.GetCollisionDetector();
    if (collisionDetector.IsGrounded && moveInput.y < 0 && !isAtLadderBottom)
    {
        // ì‚¬ë‹¤ë¦¬ ì¤‘ê°„ í”Œë«í¼ì—ì„œëŠ” ê³„ì† ì•„ë˜ë¡œ ì´ë™í•  ìˆ˜ ìˆë„ë¡ ì†ë„ ë³´ì¥
        climbVelocity.y = moveInput.y * climbSpeed;
    }

    // ì‚¬ë‹¤ë¦¬ì—ì„œì˜ ì´ë™ ì ìš©
    movement.ClimbMove(climbVelocity);

    // ê°•ì œ ìœ„ì¹˜ ê³ ì •
    if (forceCenterAlignment && currentLadderCollider != null)
    {
        Vector3 pos = player.transform.position;
        pos.x = ladderCenterX;
        player.transform.position = pos;
    }
}
```

## í•™ìŠµ í¬ì¸íŠ¸ (TIL)

1. ë ˆì´ì–´ ê¸°ë°˜ ì¶©ëŒ ê´€ë¦¬
   - ë ˆì´ì–´ë¥¼ ë³€ê²½í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë¬¼ë¦¬ì  ì¶©ëŒì„ íš¨ìœ¨ì ìœ¼ë¡œ ì œì–´í•  ìˆ˜ ìˆìŒ
   - LayerMaskë¥¼ ì´ìš©í•œ íŠ¹ì • ë ˆì´ì–´ë§Œ ê°ì§€í•˜ëŠ” ì¶©ëŒ ê²€ì‚¬ ë°©ì‹
   - ì½”ë“œ: `player.gameObject.layer = ladderLayer;`
2. ìƒíƒœ íŒ¨í„´ í™œìš©
   - ë³µì¡í•œ í”Œë ˆì´ì–´ ë™ì‘ì„ ìƒíƒœ íŒ¨í„´ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ê´€ë¦¬
   - ê° ìƒíƒœ(State)ê°€ ìì‹ ì˜ Enter, Update, Exit ë¡œì§ì„ ê°€ì§
   - ì½”ë“œ: `player.ExitClimbingState(false);`
3. Rigidbody2D ì¡°ì‘
   - ì¤‘ë ¥ ìŠ¤ì¼€ì¼ì„ 0ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ìì—°ìŠ¤ëŸ¬ìš´ ë¶€ìœ  ìƒíƒœ ë§Œë“¤ê¸°
   - íŠ¹ì • ìƒí™©ì—ì„œ ì•½ê°„ì˜ ì¤‘ë ¥(0.1f)ì„ ë¶€ì—¬í•˜ì—¬ ë¯¸ì„¸í•˜ê²Œ ë–¨ì–´ì§€ëŠ” íš¨ê³¼ ìƒì„±
   - ì½”ë“œ: `rigidbody.gravityScale = 0f;`
4. ìœ„ì¹˜ ê°•ì œ ê³ ì • ê¸°ë²•
   - Transform ìœ„ì¹˜ë¥¼ ì§ì ‘ ìˆ˜ì •í•˜ì—¬ ë¶€ë“œëŸ¬ìš´ ì •ë ¬ êµ¬í˜„
   - ì½”ë“œ: `playerTransform.position = newPosition;`
5. ìƒí™©ë³„ í”Œë ˆì´ì–´ ì²˜ë¦¬
   - í”Œë«í¼ì—ì„œ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ëŠ” ê²½ìš°ì™€ ì¼ë°˜ ì‚¬ë‹¤ë¦¬ ì ‘ê·¼ì„ êµ¬ë¶„
   - ì‚¬ë‹¤ë¦¬ ë°”ë‹¥ì— ìˆì„ ë•Œë§Œ ë‚´ë¦´ ìˆ˜ ìˆê²Œ í•˜ì—¬ ìì—°ìŠ¤ëŸ¬ìš´ ìƒí˜¸ì‘ìš©
   - ì½”ë“œ: `isAtLadderBottom = Mathf.Abs(playerBottom - ladderBottom) < threshold;`

## ê²°ë¡ 

ì´ ì‚¬ë‹¤ë¦¬ ì‹œìŠ¤í…œì€ ë ˆì´ì–´ ë³€ê²½ê³¼ ì¤‘ì•™ ì •ë ¬ì´ë¼ëŠ” ë‘ ê°€ì§€ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ì„ í†µí•´ í”Œë ˆì´ì–´ê°€ ì‚¬ë‹¤ë¦¬ì™€ ìì—°ìŠ¤ëŸ½ê²Œ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„ë˜ì—ˆëŠ”ë° íŠ¹íˆ í”Œë«í¼ ìœ„ì—ì„œ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ëŠ” ìƒí™©ê³¼ ê°™ì€ ì—ì§€ ì¼€ì´ìŠ¤ì— ëŒ€í•œ ì„¸ì‹¬í•œ ì²˜ë¦¬ê°€ í•µì‹¬ì´ë‹¤. ì´ëŸ¬í•œ ì ‘ê·¼ ë°©ì‹ì€ 2D í”Œë«í¬ë¨¸ ê²Œì„ì—ì„œ ì‚¬ë‹¤ë¦¬ ë©”ì»¤ë‹ˆì¦˜ì„ êµ¬í˜„í•  ë•Œ ì°¸ê³ í•  ë§Œí•œ í•˜ë‚˜ì˜ ë°©ë²•ì´ ë˜ì—ˆë‹¤.

ì¶”ê°€ì ì¸ ìš”ì†Œë¡œ ê¸°ì¡´ì½”ë“œì— ì¤‘ì•™ì •ë ¬ì„ ì¶”ê°€í•˜ì—¬ ì‚¬ë‹¤ë¦¬ ì‹œìŠ¤í…œì„ ì™„ì„±í•˜ì˜€ë‹¤.

ì‚¬ë‹¤ë¦¬ì—ì„œ ë°”ë‹¥ì„ ê°ì§€í•˜ì—¬ ë‚´ë¦¬ë˜ ì½”ë“œë¡œ ì¸í•´ í”Œë«í¼ìœ„ì—ì„œëŠ” ì•„ë˜ë¡œ ë‚´ë ¤ê°€ì§€ ëª»í–ˆëŠ”ë° ì•„ë˜ë¡œ ë‚´ë ¤ê°€ëŠ” ê²½ìš°ë¥¼ ë”°ë¡œ êµ¬ë¶„í•˜ì—¬ í”Œë«í¼ ìœ„ì—ì„œë„ í•˜ê°• í•  ìˆ˜ ìˆê²Œ ë§Œë“¤ì—ˆë‹¤.

